{"remainingRequest":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/src/components/Asistencia.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/src/components/Asistencia.vue","mtime":1600969012730},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBpbmZvIGZyb20gIkAvaW5mb3JtYXRpb24iOwppbXBvcnQgZmIgZnJvbSAiQC9mYiI7CmltcG9ydCBEaWFsb2cgZnJvbSAiQC9jb21wb25lbnRzL0RpYWxvZyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IFsibW9kZSIsICJzaGFyZSJdLAogIGNvbXBvbmVudHM6IHsKICAgIERpYWxvZwogIH0sCiAgZGF0YTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gewogICAgICBzaG93VGFibGU6ICJkaXNwbGF5Om5vbmUiLAogICAgICB0YWJsZVN0eWxlOiAiIiwKICAgICAgc2hvd1NoYXJlRGlhbG9nOiB0cnVlLAogICAgICBpbmZvUm93OiBudWxsLAogICAgICBjb3VudDogMCwKICAgICAgdGFiczogbnVsbCwKICAgICAgc2VsZWN0ZWRQbGF5ZXI6IG51bGwsCiAgICAgIHBsYXllcnNMaXN0TmFtZXM6IFtdLAogICAgICBpbmZvQXNpc3RlbmNpYTogW10sCiAgICAgIHNoYXJlQ29udGVudDoge30KICAgIH07CiAgfSwKICB3YXRjaDogewogICAgc2VsZWN0ZWRQbGF5ZXI6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnNob3dUYWJsZSA9ICJkaXNwbGF5OmZsZXgiOwogICAgICB0aGlzLmdlbmVyYXRlVGFibGUodGhpcy5zZWxlY3RlZFBsYXllcik7CiAgICB9LAogICAgbW9kZTogZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLm1vZGUgPT0gMSkgewogICAgICAgIHRoaXMudGFibGVTdHlsZSA9ICJjdXJzb3I6cG9pbnRlcjsgYmFja2dyb3VuZC1jb2xvcjojQ0ZEOERDIjsKICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGUgPT0gMCkgewogICAgICAgIHRoaXMudGFibGVTdHlsZSA9ICIiOwogICAgICB9CiAgICB9LAogICAgc2hhcmU6IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5zaGFyZSA9PSAxKSB7CiAgICAgICAgdGhpcy5vcGVuU2hhcmUoKTsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgY2FsY3VsYXRlTWF0Y2hlc0F1dG86IGZ1bmN0aW9uKGEpIHsKICAgICAgbGV0IGNvdW50ID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChhW2ldID09ICJZRVMiKSB7CiAgICAgICAgICBjb3VudCsrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGNvdW50OwogICAgfSwKICAgIG9wZW5TaGFyZTogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuJGVtaXQoImVuZFNoYXJpbmciKTsKICAgICAgbGV0IHQgPSAiUmVzdW1lbiBkZSBsYSBhc2lzdGVuY2lhOlxuIjsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5pbmZvQXNpc3RlbmNpYS5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBuID0gdGhpcy5pbmZvQXNpc3RlbmNpYVtpXS5OYW1lOwogICAgICAgIGxldCBwID0gdGhpcy5jYWxjdWxhdGVNYXRjaGVzQXV0bygKICAgICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5pbmZvQXNpc3RlbmNpYVtpXSkKICAgICAgICApOwogICAgICAgIHQgKz0gYFx0JHtufSAtLT4gJHtwfS8zMFxuYDsKICAgICAgfQoKICAgICAgdGhpcy5zaG93U2hhcmVEaWFsb2cgPSB0cnVlOwogICAgICB0aGlzLnNoYXJlQ29udGVudC50aXRsZSA9ICJSZXN1bWVuIGRlIGxhIGFzaXN0ZW5jaWEiOwogICAgICB0aGlzLnNoYXJlQ29udGVudC5pbmZvID0gdDsKICAgIH0sCiAgICBnZW5lcmF0ZVRhYmxlOiBmdW5jdGlvbihwbGF5ZXIpIHsKICAgICAgdGhpcy5pbmZvUm93ID0gW107CiAgICAgIHRoaXMuY291bnQgPSAwOwoKICAgICAgbGV0IGluZGV4ID0gdGhpcy5sb29rRm9ySW5kZXhpbkluZm8ocGxheWVyKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDMwOyBpKyspIHsKICAgICAgICBsZXQgYSA9ICIiOwoKICAgICAgICBpZiAoZXZhbCgidGhpcy5pbmZvQXNpc3RlbmNpYVsiICsgaW5kZXggKyAiXS5TdGF0dXNKIiArIGkpID09ICJZRVMiKSB7CiAgICAgICAgICBhID0gIlgiOwogICAgICAgICAgdGhpcy5jb3VudCsrOwogICAgICAgIH0KCiAgICAgICAgbGV0IHAgPSB7CiAgICAgICAgICBuYW1lOiAiSiIgKyBpLAogICAgICAgICAgajogYQogICAgICAgIH07CgogICAgICAgIHRoaXMuaW5mb1Jvdy5wdXNoKHApOwogICAgICB9CiAgICB9LAogICAgbG9va0ZvckluZGV4aW5JbmZvOiBmdW5jdGlvbihuYW1lKSB7CiAgICAgIGxldCBpID0gMDsKICAgICAgbGV0IGZvdW5kID0gZmFsc2U7CiAgICAgIGxldCBzaXplID0gdGhpcy5pbmZvQXNpc3RlbmNpYS5sZW5ndGg7CgogICAgICB3aGlsZSAoaSA8IHNpemUgJiYgIWZvdW5kKSB7CiAgICAgICAgaWYgKG5hbWUgPT0gdGhpcy5pbmZvQXNpc3RlbmNpYVtpXS5OYW1lKSB7CiAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGkrKzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChmb3VuZCkgewogICAgICAgIHJldHVybiBpOwogICAgICB9CiAgICB9LAogICAgbWFyazogZnVuY3Rpb24obmFtZSkgewogICAgICBpZiAodGhpcy5tb2RlID09IDEpIHsKICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmxvb2tGb3JJbmRleChuYW1lKTsKICAgICAgICBsZXQgcCA9IHt9OwogICAgICAgIGxldCBpbmRleDMgPSBpbmRleCArIDE7CgogICAgICAgIGlmICh0aGlzLmluZm9Sb3dbaW5kZXhdLmogPT0gIiIpIHsKICAgICAgICAgIHRoaXMuaW5mb1Jvd1tpbmRleF0uaiA9ICJYIjsKICAgICAgICAgIHRoaXMuY291bnQrKzsKICAgICAgICAgIGV2YWwoInAuU3RhdHVzSiIgKyBpbmRleDMgKyAnID0gIllFUyI7Jyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuaW5mb1Jvd1tpbmRleF0uaiA9ICIiOwogICAgICAgICAgdGhpcy5jb3VudC0tOwogICAgICAgICAgZXZhbCgicC5TdGF0dXNKIiArIGluZGV4MyArICcgPSAiTk8iOycpOwogICAgICAgIH0KCiAgICAgICAgbGV0IGluZGV4MiA9IHRoaXMubG9va0ZvckluZGV4aW5JbmZvKHRoaXMuc2VsZWN0ZWRQbGF5ZXIpOwogICAgICAgIGxldCBpZCA9IHRoaXMuaW5mb0FzaXN0ZW5jaWFbaW5kZXgyXS5pZDsKCiAgICAgICAgZmIuZGIKICAgICAgICAgIC5jb2xsZWN0aW9uKCJBc2lzdGVuY2lhIikKICAgICAgICAgIC5kb2MoaWQpCiAgICAgICAgICAudXBkYXRlKHApOwoKICAgICAgICB0aGlzLnVwZGF0ZSgpOwogICAgICB9CiAgICB9LAogICAgbG9va0ZvckluZGV4OiBmdW5jdGlvbihuYW1lKSB7CiAgICAgIGxldCBpID0gMDsKICAgICAgbGV0IGZvdW5kID0gZmFsc2U7CiAgICAgIGxldCBzaXplID0gdGhpcy5pbmZvUm93Lmxlbmd0aDsKCiAgICAgIHdoaWxlIChpIDwgc2l6ZSAmJiAhZm91bmQpIHsKICAgICAgICBpZiAobmFtZSA9PSB0aGlzLmluZm9Sb3dbaV0ubmFtZSkgewogICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpKys7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZm91bmQpIHsKICAgICAgICByZXR1cm4gaTsKICAgICAgfQogICAgfSwKICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuaW5mb0FzaXN0ZW5jaWEgPSBbXTsKCiAgICAgIGZiLmRiLmNvbGxlY3Rpb24oIkFzaXN0ZW5jaWEiKS5vblNuYXBzaG90KHJlcyA9PiB7CiAgICAgICAgY29uc3QgY2hhbmdlcyA9IHJlcy5kb2NDaGFuZ2VzKCk7CgogICAgICAgIGNoYW5nZXMuZm9yRWFjaChjaGFuZ2UgPT4gewogICAgICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAiYWRkZWQiKSB7CiAgICAgICAgICAgIGxldCB0ID0gY2hhbmdlLmRvYy5kYXRhKCk7CgogICAgICAgICAgICB0LmlkID0gY2hhbmdlLmRvYy5pZDsKCiAgICAgICAgICAgIHRoaXMuaW5mb0FzaXN0ZW5jaWEucHVzaCh0KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbigpIHsKICAgIHRoaXMucGxheWVyc0xpc3ROYW1lcyA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5mby5wbGF5ZXJzTGlzdC5sZW5ndGg7IGkrKykgewogICAgICB0aGlzLnBsYXllcnNMaXN0TmFtZXMucHVzaChpbmZvLnBsYXllcnNMaXN0W2ldLnBsYXllck5hbWUpOwogICAgfQoKICAgIHRoaXMudXBkYXRlKCk7CiAgfQp9Owo="},{"version":3,"sources":["Asistencia.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"Asistencia.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"asistencia\">\n    <div class=\"try\">\n      <Dialog\n        :statusDialog=\"showShareDialog\"\n        v-on:statusClosed=\"showShareDialog=false;\"\n        :content=\"shareContent\"\n      ></Dialog>\n      <v-select v-model=\"selectedPlayer\" label=\"Escoger jugador\" :items=\"playersListNames\"></v-select>\n\n      <div :style=\"showTable\" class=\"centeredColumn\">\n        <v-card id=\"saldoCard\" style=\"background-color:#F4FF81\">\n          <h4>Partidos: {{count}}/30</h4>\n        </v-card>\n\n        <v-simple-table style=\"width:40vw; margin-top:20px;\">\n          <template v-slot:default>\n            <thead>\n              <tr>\n                <th class=\"text-align:center\">Jugador</th>\n                <th class=\"text-align:center\">{{selectedPlayer}}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"item in infoRow\" :key=\"item.name\">\n                <td>{{ item.name }}</td>\n                <td @click=\"mark(item.name)\" :style=\"tableStyle\">{{ item.j}}</td>\n              </tr>\n            </tbody>\n          </template>\n        </v-simple-table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport info from \"@/information\";\nimport fb from \"@/fb\";\nimport Dialog from \"@/components/Dialog\";\n\nexport default {\n  props: [\"mode\", \"share\"],\n  components: {\n    Dialog\n  },\n  data: function() {\n    return {\n      showTable: \"display:none\",\n      tableStyle: \"\",\n      showShareDialog: true,\n      infoRow: null,\n      count: 0,\n      tabs: null,\n      selectedPlayer: null,\n      playersListNames: [],\n      infoAsistencia: [],\n      shareContent: {}\n    };\n  },\n  watch: {\n    selectedPlayer: function() {\n      this.showTable = \"display:flex\";\n      this.generateTable(this.selectedPlayer);\n    },\n    mode: function() {\n      if (this.mode == 1) {\n        this.tableStyle = \"cursor:pointer; background-color:#CFD8DC\";\n      } else if (this.mode == 0) {\n        this.tableStyle = \"\";\n      }\n    },\n    share: function() {\n      if (this.share == 1) {\n        this.openShare();\n      }\n    }\n  },\n  methods: {\n    calculateMatchesAuto: function(a) {\n      let count = 0;\n\n      for (let i = 0; i < a.length; i++) {\n        if (a[i] == \"YES\") {\n          count++;\n        }\n      }\n\n      return count;\n    },\n    openShare: function() {\n      this.$emit(\"endSharing\");\n      let t = \"Resumen de la asistencia:\\n\";\n\n      for (let i = 0; i < this.infoAsistencia.length; i++) {\n        let n = this.infoAsistencia[i].Name;\n        let p = this.calculateMatchesAuto(\n          Object.values(this.infoAsistencia[i])\n        );\n        t += `\\t${n} --> ${p}/30\\n`;\n      }\n\n      this.showShareDialog = true;\n      this.shareContent.title = \"Resumen de la asistencia\";\n      this.shareContent.info = t;\n    },\n    generateTable: function(player) {\n      this.infoRow = [];\n      this.count = 0;\n\n      let index = this.lookForIndexinInfo(player);\n\n      for (let i = 1; i <= 30; i++) {\n        let a = \"\";\n\n        if (eval(\"this.infoAsistencia[\" + index + \"].StatusJ\" + i) == \"YES\") {\n          a = \"X\";\n          this.count++;\n        }\n\n        let p = {\n          name: \"J\" + i,\n          j: a\n        };\n\n        this.infoRow.push(p);\n      }\n    },\n    lookForIndexinInfo: function(name) {\n      let i = 0;\n      let found = false;\n      let size = this.infoAsistencia.length;\n\n      while (i < size && !found) {\n        if (name == this.infoAsistencia[i].Name) {\n          found = true;\n        } else {\n          i++;\n        }\n      }\n\n      if (found) {\n        return i;\n      }\n    },\n    mark: function(name) {\n      if (this.mode == 1) {\n        let index = this.lookForIndex(name);\n        let p = {};\n        let index3 = index + 1;\n\n        if (this.infoRow[index].j == \"\") {\n          this.infoRow[index].j = \"X\";\n          this.count++;\n          eval(\"p.StatusJ\" + index3 + ' = \"YES\";');\n        } else {\n          this.infoRow[index].j = \"\";\n          this.count--;\n          eval(\"p.StatusJ\" + index3 + ' = \"NO\";');\n        }\n\n        let index2 = this.lookForIndexinInfo(this.selectedPlayer);\n        let id = this.infoAsistencia[index2].id;\n\n        fb.db\n          .collection(\"Asistencia\")\n          .doc(id)\n          .update(p);\n\n        this.update();\n      }\n    },\n    lookForIndex: function(name) {\n      let i = 0;\n      let found = false;\n      let size = this.infoRow.length;\n\n      while (i < size && !found) {\n        if (name == this.infoRow[i].name) {\n          found = true;\n        } else {\n          i++;\n        }\n      }\n\n      if (found) {\n        return i;\n      }\n    },\n    update: function() {\n      this.infoAsistencia = [];\n\n      fb.db.collection(\"Asistencia\").onSnapshot(res => {\n        const changes = res.docChanges();\n\n        changes.forEach(change => {\n          if (change.type === \"added\") {\n            let t = change.doc.data();\n\n            t.id = change.doc.id;\n\n            this.infoAsistencia.push(t);\n          }\n        });\n      });\n    }\n  },\n  created: function() {\n    this.playersListNames = [];\n\n    for (let i = 0; i < info.playersList.length; i++) {\n      this.playersListNames.push(info.playersList[i].playerName);\n    }\n\n    this.update();\n  }\n};\n</script>\n"]}]}