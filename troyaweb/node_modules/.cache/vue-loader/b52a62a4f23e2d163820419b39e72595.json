{"remainingRequest":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/src/components/Asistencia.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/src/components/Asistencia.vue","mtime":1593853614060},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/RepoGitHub/Troya-PWA/troyaweb/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBpbmZvIGZyb20gIkAvaW5mb3JtYXRpb24iOwppbXBvcnQgZmIgZnJvbSAiQC9mYiI7CmltcG9ydCBEaWFsb2cgZnJvbSAiQC9jb21wb25lbnRzL0RpYWxvZyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IFsibW9kZSIsICJzaGFyZSJdLAogIGNvbXBvbmVudHM6IHsKICAgIERpYWxvZwogIH0sCiAgZGF0YTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gewogICAgICBzaG93VGFibGU6ICJkaXNwbGF5Om5vbmUiLAogICAgICB0YWJsZVN0eWxlOiAiIiwKICAgICAgc2hvd1NoYXJlRGlhbG9nOiBmYWxzZSwKICAgICAgaW5mb1JvdzogbnVsbCwKICAgICAgY291bnQ6IDAsCiAgICAgIHRhYnM6IG51bGwsCiAgICAgIHNlbGVjdGVkUGxheWVyOiBudWxsLAogICAgICBwbGF5ZXJzTGlzdE5hbWVzOiBbXSwKICAgICAgaW5mb0FzaXN0ZW5jaWE6IFtdLAogICAgICBzaGFyZUNvbnRlbnQ6IHt9CiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIHNlbGVjdGVkUGxheWVyOiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5zaG93VGFibGUgPSAiZGlzcGxheTpmbGV4IjsKICAgICAgdGhpcy5nZW5lcmF0ZVRhYmxlKHRoaXMuc2VsZWN0ZWRQbGF5ZXIpOwogICAgfSwKICAgIG1vZGU6IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5tb2RlID09IDEpIHsKICAgICAgICB0aGlzLnRhYmxlU3R5bGUgPSAiY3Vyc29yOnBvaW50ZXI7IGJhY2tncm91bmQtY29sb3I6I0NGRDhEQyI7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09IDApIHsKICAgICAgICB0aGlzLnRhYmxlU3R5bGUgPSAiIjsKICAgICAgfQogICAgfSwKICAgIHNoYXJlOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuc2hhcmUgPT0gMSkgewogICAgICAgIHRoaXMub3BlblNoYXJlKCk7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGNhbGN1bGF0ZU1hdGNoZXNBdXRvOiBmdW5jdGlvbihhKSB7CiAgICAgIGxldCBjb3VudCA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoYVtpXSA9PSAiWUVTIikgewogICAgICAgICAgY291bnQrKzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBjb3VudDsKICAgIH0sCiAgICBvcGVuU2hhcmU6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLiRlbWl0KCJlbmRTaGFyaW5nIik7CiAgICAgIGxldCB0ID0gIlJlc3VtZW4gZGUgbGEgYXNpc3RlbmNpYTpcbiI7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaW5mb0FzaXN0ZW5jaWEubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgbiA9IHRoaXMuaW5mb0FzaXN0ZW5jaWFbaV0uTmFtZTsKICAgICAgICBsZXQgcCA9IHRoaXMuY2FsY3VsYXRlTWF0Y2hlc0F1dG8oCiAgICAgICAgICBPYmplY3QudmFsdWVzKHRoaXMuaW5mb0FzaXN0ZW5jaWFbaV0pCiAgICAgICAgKTsKICAgICAgICB0ICs9IGBcdCR7bn0gLS0+ICR7cH0vMzBcbmA7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hvd1NoYXJlRGlhbG9nID0gdHJ1ZTsKICAgICAgdGhpcy5zaGFyZUNvbnRlbnQudGl0bGUgPSAiUmVzdW1lbiBkZSBsYSBhc2lzdGVuY2lhIjsKICAgICAgdGhpcy5zaGFyZUNvbnRlbnQuaW5mbyA9IHQ7CiAgICB9LAogICAgZ2VuZXJhdGVUYWJsZTogZnVuY3Rpb24ocGxheWVyKSB7CiAgICAgIHRoaXMuaW5mb1JvdyA9IFtdOwogICAgICB0aGlzLmNvdW50ID0gMDsKCiAgICAgIGxldCBpbmRleCA9IHRoaXMubG9va0ZvckluZGV4aW5JbmZvKHBsYXllcik7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSAzMDsgaSsrKSB7CiAgICAgICAgbGV0IGEgPSAiIjsKCiAgICAgICAgaWYgKGV2YWwoInRoaXMuaW5mb0FzaXN0ZW5jaWFbIiArIGluZGV4ICsgIl0uU3RhdHVzSiIgKyBpKSA9PSAiWUVTIikgewogICAgICAgICAgYSA9ICJYIjsKICAgICAgICAgIHRoaXMuY291bnQrKzsKICAgICAgICB9CgogICAgICAgIGxldCBwID0gewogICAgICAgICAgbmFtZTogIkoiICsgaSwKICAgICAgICAgIGo6IGEKICAgICAgICB9OwoKICAgICAgICB0aGlzLmluZm9Sb3cucHVzaChwKTsKICAgICAgfQogICAgfSwKICAgIGxvb2tGb3JJbmRleGluSW5mbzogZnVuY3Rpb24obmFtZSkgewogICAgICBsZXQgaSA9IDA7CiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICBsZXQgc2l6ZSA9IHRoaXMuaW5mb0FzaXN0ZW5jaWEubGVuZ3RoOwoKICAgICAgd2hpbGUgKGkgPCBzaXplICYmICFmb3VuZCkgewogICAgICAgIGlmIChuYW1lID09IHRoaXMuaW5mb0FzaXN0ZW5jaWFbaV0uTmFtZSkgewogICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpKys7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZm91bmQpIHsKICAgICAgICByZXR1cm4gaTsKICAgICAgfQogICAgfSwKICAgIG1hcms6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgaWYgKHRoaXMubW9kZSA9PSAxKSB7CiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5sb29rRm9ySW5kZXgobmFtZSk7CiAgICAgICAgbGV0IHAgPSB7fTsKICAgICAgICBsZXQgaW5kZXgzID0gaW5kZXggKyAxOwoKICAgICAgICBpZiAodGhpcy5pbmZvUm93W2luZGV4XS5qID09ICIiKSB7CiAgICAgICAgICB0aGlzLmluZm9Sb3dbaW5kZXhdLmogPSAiWCI7CiAgICAgICAgICB0aGlzLmNvdW50Kys7CiAgICAgICAgICBldmFsKCJwLlN0YXR1c0oiICsgaW5kZXgzICsgJyA9ICJZRVMiOycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmluZm9Sb3dbaW5kZXhdLmogPSAiIjsKICAgICAgICAgIHRoaXMuY291bnQtLTsKICAgICAgICAgIGV2YWwoInAuU3RhdHVzSiIgKyBpbmRleDMgKyAnID0gIk5PIjsnKTsKICAgICAgICB9CgogICAgICAgIGxldCBpbmRleDIgPSB0aGlzLmxvb2tGb3JJbmRleGluSW5mbyh0aGlzLnNlbGVjdGVkUGxheWVyKTsKICAgICAgICBsZXQgaWQgPSB0aGlzLmluZm9Bc2lzdGVuY2lhW2luZGV4Ml0uaWQ7CgogICAgICAgIGZiLmRiCiAgICAgICAgICAuY29sbGVjdGlvbigiQXNpc3RlbmNpYSIpCiAgICAgICAgICAuZG9jKGlkKQogICAgICAgICAgLnVwZGF0ZShwKTsKCiAgICAgICAgdGhpcy51cGRhdGUoKTsKICAgICAgfQogICAgfSwKICAgIGxvb2tGb3JJbmRleDogZnVuY3Rpb24obmFtZSkgewogICAgICBsZXQgaSA9IDA7CiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICBsZXQgc2l6ZSA9IHRoaXMuaW5mb1Jvdy5sZW5ndGg7CgogICAgICB3aGlsZSAoaSA8IHNpemUgJiYgIWZvdW5kKSB7CiAgICAgICAgaWYgKG5hbWUgPT0gdGhpcy5pbmZvUm93W2ldLm5hbWUpIHsKICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgcmV0dXJuIGk7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGU6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmluZm9Bc2lzdGVuY2lhID0gW107CgogICAgICBmYi5kYi5jb2xsZWN0aW9uKCJBc2lzdGVuY2lhIikub25TbmFwc2hvdChyZXMgPT4gewogICAgICAgIGNvbnN0IGNoYW5nZXMgPSByZXMuZG9jQ2hhbmdlcygpOwoKICAgICAgICBjaGFuZ2VzLmZvckVhY2goY2hhbmdlID0+IHsKICAgICAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gImFkZGVkIikgewogICAgICAgICAgICBsZXQgdCA9IGNoYW5nZS5kb2MuZGF0YSgpOwoKICAgICAgICAgICAgdC5pZCA9IGNoYW5nZS5kb2MuaWQ7CgogICAgICAgICAgICB0aGlzLmluZm9Bc2lzdGVuY2lhLnB1c2godCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnBsYXllcnNMaXN0TmFtZXMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluZm8ucGxheWVyc0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgdGhpcy5wbGF5ZXJzTGlzdE5hbWVzLnB1c2goaW5mby5wbGF5ZXJzTGlzdFtpXS5wbGF5ZXJOYW1lKTsKICAgIH0KCiAgICB0aGlzLnVwZGF0ZSgpOwogIH0KfTsK"},{"version":3,"sources":["Asistencia.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"Asistencia.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"asistencia\">\n    <div class=\"try\">\n      <Dialog\n        :statusDialog=\"showShareDialog\"\n        v-on:statusClosed=\"showShareDialog=false;\"\n        :content=\"shareContent\"\n      ></Dialog>\n      <v-select v-model=\"selectedPlayer\" label=\"Escoger jugador\" :items=\"playersListNames\"></v-select>\n\n      <div :style=\"showTable\" class=\"centeredColumn\">\n        <v-card id=\"saldoCard\" style=\"background-color:#F4FF81\">\n          <h4>Partidos: {{count}}/30</h4>\n        </v-card>\n\n        <v-simple-table style=\"width:40vw; margin-top:20px;\">\n          <template v-slot:default>\n            <thead>\n              <tr>\n                <th class=\"text-align:center\">Jugador</th>\n                <th class=\"text-align:center\">{{selectedPlayer}}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"item in infoRow\" :key=\"item.name\">\n                <td>{{ item.name }}</td>\n                <td @click=\"mark(item.name)\" :style=\"tableStyle\">{{ item.j}}</td>\n              </tr>\n            </tbody>\n          </template>\n        </v-simple-table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport info from \"@/information\";\nimport fb from \"@/fb\";\nimport Dialog from \"@/components/Dialog\";\n\nexport default {\n  props: [\"mode\", \"share\"],\n  components: {\n    Dialog\n  },\n  data: function() {\n    return {\n      showTable: \"display:none\",\n      tableStyle: \"\",\n      showShareDialog: false,\n      infoRow: null,\n      count: 0,\n      tabs: null,\n      selectedPlayer: null,\n      playersListNames: [],\n      infoAsistencia: [],\n      shareContent: {}\n    };\n  },\n  watch: {\n    selectedPlayer: function() {\n      this.showTable = \"display:flex\";\n      this.generateTable(this.selectedPlayer);\n    },\n    mode: function() {\n      if (this.mode == 1) {\n        this.tableStyle = \"cursor:pointer; background-color:#CFD8DC\";\n      } else if (this.mode == 0) {\n        this.tableStyle = \"\";\n      }\n    },\n    share: function() {\n      if (this.share == 1) {\n        this.openShare();\n      }\n    }\n  },\n  methods: {\n    calculateMatchesAuto: function(a) {\n      let count = 0;\n\n      for (let i = 0; i < a.length; i++) {\n        if (a[i] == \"YES\") {\n          count++;\n        }\n      }\n\n      return count;\n    },\n    openShare: function() {\n      this.$emit(\"endSharing\");\n      let t = \"Resumen de la asistencia:\\n\";\n\n      for (let i = 0; i < this.infoAsistencia.length; i++) {\n        let n = this.infoAsistencia[i].Name;\n        let p = this.calculateMatchesAuto(\n          Object.values(this.infoAsistencia[i])\n        );\n        t += `\\t${n} --> ${p}/30\\n`;\n      }\n\n      this.showShareDialog = true;\n      this.shareContent.title = \"Resumen de la asistencia\";\n      this.shareContent.info = t;\n    },\n    generateTable: function(player) {\n      this.infoRow = [];\n      this.count = 0;\n\n      let index = this.lookForIndexinInfo(player);\n\n      for (let i = 1; i <= 30; i++) {\n        let a = \"\";\n\n        if (eval(\"this.infoAsistencia[\" + index + \"].StatusJ\" + i) == \"YES\") {\n          a = \"X\";\n          this.count++;\n        }\n\n        let p = {\n          name: \"J\" + i,\n          j: a\n        };\n\n        this.infoRow.push(p);\n      }\n    },\n    lookForIndexinInfo: function(name) {\n      let i = 0;\n      let found = false;\n      let size = this.infoAsistencia.length;\n\n      while (i < size && !found) {\n        if (name == this.infoAsistencia[i].Name) {\n          found = true;\n        } else {\n          i++;\n        }\n      }\n\n      if (found) {\n        return i;\n      }\n    },\n    mark: function(name) {\n      if (this.mode == 1) {\n        let index = this.lookForIndex(name);\n        let p = {};\n        let index3 = index + 1;\n\n        if (this.infoRow[index].j == \"\") {\n          this.infoRow[index].j = \"X\";\n          this.count++;\n          eval(\"p.StatusJ\" + index3 + ' = \"YES\";');\n        } else {\n          this.infoRow[index].j = \"\";\n          this.count--;\n          eval(\"p.StatusJ\" + index3 + ' = \"NO\";');\n        }\n\n        let index2 = this.lookForIndexinInfo(this.selectedPlayer);\n        let id = this.infoAsistencia[index2].id;\n\n        fb.db\n          .collection(\"Asistencia\")\n          .doc(id)\n          .update(p);\n\n        this.update();\n      }\n    },\n    lookForIndex: function(name) {\n      let i = 0;\n      let found = false;\n      let size = this.infoRow.length;\n\n      while (i < size && !found) {\n        if (name == this.infoRow[i].name) {\n          found = true;\n        } else {\n          i++;\n        }\n      }\n\n      if (found) {\n        return i;\n      }\n    },\n    update: function() {\n      this.infoAsistencia = [];\n\n      fb.db.collection(\"Asistencia\").onSnapshot(res => {\n        const changes = res.docChanges();\n\n        changes.forEach(change => {\n          if (change.type === \"added\") {\n            let t = change.doc.data();\n\n            t.id = change.doc.id;\n\n            this.infoAsistencia.push(t);\n          }\n        });\n      });\n    }\n  },\n  created: function() {\n    this.playersListNames = [];\n\n    for (let i = 0; i < info.playersList.length; i++) {\n      this.playersListNames.push(info.playersList[i].playerName);\n    }\n\n    this.update();\n  }\n};\n</script>\n"]}]}